# Group Chat - Visual Architecture Diagrams

## ğŸ“Š System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          USER INTERFACE                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ChatListScreenâ”‚  â”‚ GroupChat    â”‚  â”‚ GroupMemberList    â”‚   â”‚
â”‚  â”‚               â”‚  â”‚ Screen       â”‚  â”‚ Modal              â”‚   â”‚
â”‚  â”‚ â€¢ List chats  â”‚  â”‚ â€¢ Messages   â”‚  â”‚ â€¢ Members          â”‚   â”‚
â”‚  â”‚ â€¢ 1-to-1      â”‚  â”‚ â€¢ Input      â”‚  â”‚ â€¢ Add/Remove       â”‚   â”‚
â”‚  â”‚ â€¢ Groups      â”‚  â”‚ â€¢ Actions    â”‚  â”‚ â€¢ Promote          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚          â”‚                 â”‚                     â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                 â”‚                     â”‚
           â–¼                 â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        REDUX STATE LAYER                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  chatSlice (shared by 1-to-1 and groups)                 â”‚   â”‚
â”‚  â”‚  â€¢ activeChat: { chatId, username, avatar, isGroup }     â”‚   â”‚
â”‚  â”‚  â€¢ conversations: ConversationMetadata[]                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     MANAGER LAYER (Business Logic)               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚   ChatManager       â”‚         â”‚  GroupChatManager      â”‚     â”‚
â”‚  â”‚   (1-to-1)          â”‚         â”‚  (Groups)              â”‚     â”‚
â”‚  â”‚                     â”‚         â”‚                        â”‚     â”‚
â”‚  â”‚ â€¢ sendMessage()     â”‚         â”‚ â€¢ sendGroupMessage()   â”‚     â”‚
â”‚  â”‚ â€¢ openConversation()â”‚         â”‚ â€¢ createGroup()        â”‚     â”‚
â”‚  â”‚ â€¢ markAsRead()      â”‚         â”‚ â€¢ addMember()          â”‚     â”‚
â”‚  â”‚                     â”‚         â”‚ â€¢ removeMember()       â”‚     â”‚
â”‚  â”‚                     â”‚         â”‚ â€¢ promoteMember()      â”‚     â”‚
â”‚  â”‚                     â”‚         â”‚ â€¢ joinGroupChannel()   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚             â”‚                               â”‚                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                               â”‚
              â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              DATABASE LAYER (Source of Truth - SQLite)           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ 1-to-1 Messages     â”‚         â”‚ Group Messages         â”‚     â”‚
â”‚  â”‚ td_chat_hawamahal   â”‚         â”‚ td_gchat_redfort       â”‚     â”‚
â”‚  â”‚ _212                â”‚         â”‚ _213                   â”‚     â”‚
â”‚  â”‚                     â”‚         â”‚                        â”‚     â”‚
â”‚  â”‚ â€¢ refrenceId (PK)   â”‚         â”‚ â€¢ refrenceId (PK)      â”‚     â”‚
â”‚  â”‚ â€¢ samvada_chinha    â”‚         â”‚ â€¢ samvada_chinha       â”‚     â”‚
â”‚  â”‚ â€¢ pathakah_chinha   â”‚         â”‚ â€¢ pathakah_chinha      â”‚     â”‚
â”‚  â”‚ â€¢ vishayah          â”‚         â”‚ â€¢ vishayah             â”‚     â”‚
â”‚  â”‚ â€¢ avastha           â”‚         â”‚ â€¢ avastha              â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚             â”‚                               â”‚                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚            Conversation Metadata (Shared)              â”‚     â”‚
â”‚  â”‚            td_chat_qutubminar_211                      â”‚     â”‚
â”‚  â”‚                                                        â”‚     â”‚
â”‚  â”‚ â€¢ samvada_chinha (chat/group ID)                      â”‚     â”‚
â”‚  â”‚ â€¢ samvada_nama (name)                                 â”‚     â”‚
â”‚  â”‚ â€¢ prakara ('Chat' or 'Group')                         â”‚     â”‚
â”‚  â”‚ â€¢ onlyAdminsCanMessage (group setting)                â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                               â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚         Group Members (Participants)                   â”‚     â”‚
â”‚  â”‚         td_chat_bhagwah_211                            â”‚     â”‚
â”‚  â”‚                                                        â”‚     â”‚
â”‚  â”‚ â€¢ ekatma_chinha (userId)                              â”‚     â”‚
â”‚  â”‚ â€¢ samvada_chinha_id (groupId FK)                      â”‚     â”‚
â”‚  â”‚ â€¢ bhumika ('Admin' or 'Member')                       â”‚     â”‚
â”‚  â”‚ â€¢ status ('Accepted', 'Pending', 'Removed')           â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               SOCKET LAYER (Phoenix Channels)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚             SocketService (Singleton)                    â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚ Channel: user:${userId}                                 â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚ Events Received:                                         â”‚   â”‚
â”‚  â”‚ â€¢ new_message (1-to-1 & groups)                         â”‚   â”‚
â”‚  â”‚ â€¢ group_update (member add/remove/promote/etc)          â”‚   â”‚
â”‚  â”‚ â€¢ message_updated (pin/star/reaction)                   â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚ Events Sent:                                             â”‚   â”‚
â”‚  â”‚ â€¢ new_message (with isGroup flag)                       â”‚   â”‚
â”‚  â”‚ â€¢ group_update (when admin changes group)               â”‚   â”‚
â”‚  â”‚ â€¢ typing (with groupId)                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       BACKEND (Phoenix)                          â”‚
â”‚                                                                  â”‚
â”‚  â€¢ Validates group membership                                   â”‚
â”‚  â€¢ Broadcasts messages to all members                           â”‚
â”‚  â€¢ Manages group CRUD operations                                â”‚
â”‚  â€¢ Emits group_update events                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Message Flow Diagrams

### SEND GROUP MESSAGE

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User types   â”‚
â”‚ in GroupChat â”‚
â”‚ Screen       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GroupChatManager         â”‚
â”‚ .sendGroupMessage()      â”‚
â”‚                          â”‚
â”‚ 1. Check permission      â”‚
â”‚ 2. Generate refrenceId   â”‚
â”‚ 3. Create message object â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                          â”‚
       â–¼                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Insert to DB â”‚         â”‚ Update Redux   â”‚
â”‚ (optimistic) â”‚         â”‚ (instant UI)   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                          â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ SocketService  â”‚
         â”‚ .sendMessage() â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Backend        â”‚
         â”‚ â€¢ Validates    â”‚
         â”‚ â€¢ Broadcasts   â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚             â”‚             â”‚
    â–¼             â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Member â”‚   â”‚ Member â”‚   â”‚ Member â”‚
â”‚   A    â”‚   â”‚   B    â”‚   â”‚   C    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### RECEIVE GROUP MESSAGE

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Socket       â”‚
â”‚ 'new_message'â”‚
â”‚ event        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GroupChatManager         â”‚
â”‚ .handleNewGroupMessage() â”‚
â”‚                          â”‚
â”‚ 1. Filter: is this group?â”‚
â”‚ 2. Check: am I member?   â”‚
â”‚ 3. Deduplicate           â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Insert to DB â”‚
â”‚ (td_gchat_   â”‚
â”‚  redfort_213)â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                          â”‚
       â–¼                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Update          â”‚      â”‚ Notify Redux   â”‚
â”‚ conversation    â”‚      â”‚ chatSlice      â”‚
â”‚ lastMessage     â”‚      â”‚ .addMessage()  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚ UI Re-renders  â”‚
                         â”‚ (only new      â”‚
                         â”‚  message)      â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ‘¥ Member Management Flow

### ADD MEMBER

```
Admin clicks "Add Member"
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GroupChatManager       â”‚
â”‚ .addMemberToGroup()    â”‚
â”‚                        â”‚
â”‚ 1. Check admin         â”‚
â”‚ 2. Call API            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backend                â”‚
â”‚ â€¢ Insert into          â”‚
â”‚   td_chat_bhagwah_211  â”‚
â”‚ â€¢ Emit socket event    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Socket: 'group_update' â”‚
â”‚ type: 'member_added'   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚         â”‚
    â–¼         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚All     â”‚ â”‚New     â”‚
â”‚Members â”‚ â”‚Member  â”‚
â”‚        â”‚ â”‚        â”‚
â”‚Refresh â”‚ â”‚Gets    â”‚
â”‚list    â”‚ â”‚group   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### REMOVE MEMBER

```
Admin clicks "Remove"
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GroupChatManager       â”‚
â”‚ .removeMemberFromGroup â”‚
â”‚                        â”‚
â”‚ 1. Check admin         â”‚
â”‚ 2. Confirm dialog      â”‚
â”‚ 3. Call API            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backend                â”‚
â”‚ â€¢ Update status to     â”‚
â”‚   'Removed'            â”‚
â”‚ â€¢ Emit socket event    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Socket: 'group_update' â”‚
â”‚ type: 'member_removed' â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚             â”‚
    â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚All     â”‚   â”‚Removed Memberâ”‚
â”‚Members â”‚   â”‚              â”‚
â”‚        â”‚   â”‚â€¢ Leave       â”‚
â”‚Refresh â”‚   â”‚  channel     â”‚
â”‚list    â”‚   â”‚â€¢ Remove      â”‚
â”‚        â”‚   â”‚  from DB     â”‚
â”‚        â”‚   â”‚â€¢ Navigate    â”‚
â”‚        â”‚   â”‚  away        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Three-Phase Initialization

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ App Starts / User Logs In                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 1: RESTORE STATE (Instant - 0-50ms)               â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ Read from DB   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Render UI      â”‚          â”‚
â”‚  â”‚ â€¢ Groups       â”‚         â”‚ â€¢ Chat list    â”‚          â”‚
â”‚  â”‚ â€¢ Metadata     â”‚         â”‚ â€¢ Last opened  â”‚          â”‚
â”‚  â”‚ â€¢ Last messagesâ”‚         â”‚ â€¢ Instant!     â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 2: SYNC SAFETY NET (Background - 200-2000ms)      â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ Call Sync API  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Write to DB    â”‚          â”‚
â”‚  â”‚ â€¢ Missed       â”‚         â”‚ â€¢ New groups   â”‚          â”‚
â”‚  â”‚   messages     â”‚         â”‚ â€¢ New messages â”‚          â”‚
â”‚  â”‚ â€¢ New groups   â”‚         â”‚ â€¢ Updates      â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                      â”‚                  â”‚
â”‚                                      â–¼                  â”‚
â”‚                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚                             â”‚ Notify Redux   â”‚          â”‚
â”‚                             â”‚ â€¢ Refresh UI   â”‚          â”‚
â”‚                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 3: ACTIVATE REALTIME (When socket ready)          â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ Wait for       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Join all       â”‚          â”‚
â”‚  â”‚ socket         â”‚         â”‚ group channels â”‚          â”‚
â”‚  â”‚ connection     â”‚         â”‚                â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                      â”‚                  â”‚
â”‚                                      â–¼                  â”‚
â”‚                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚                             â”‚ Subscribe to   â”‚          â”‚
â”‚                             â”‚ events         â”‚          â”‚
â”‚                             â”‚ â€¢ new_message  â”‚          â”‚
â”‚                             â”‚ â€¢ group_update â”‚          â”‚
â”‚                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Data Flow Comparison

### 1-TO-1 CHAT

```
User A                          User B
  â”‚                               â”‚
  â”‚ Send message                  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
  â”‚              â”‚                â”‚
  â–¼              â–¼                â”‚
â”Œâ”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚ DB â”‚       â”‚ Socket â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â””â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
  â”‚                               â–¼
  â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                          â”‚ Socket â”‚
  â”‚                          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
  â”‚                               â”‚
  â”‚                               â–¼
  â”‚                          â”Œâ”€â”€â”€â”€â”
  â”‚                          â”‚ DB â”‚
  â”‚                          â””â”€â”€â”€â”€â”˜
  â”‚                               â”‚
  â–¼                               â–¼
[UI shows message]          [UI shows message]
```

### GROUP CHAT

```
User A              User B              User C
  â”‚                   â”‚                   â”‚
  â”‚ Send message      â”‚                   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚                   â”‚
  â”‚          â”‚        â”‚                   â”‚
  â–¼          â–¼        â”‚                   â”‚
â”Œâ”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                   â”‚
â”‚ DB â”‚   â”‚ Socket â”‚â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â””â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â”‚                   â”‚
  â”‚           â”‚      â”‚                   â”‚
  â”‚      â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”             â”‚
  â”‚      â”‚                  â”‚             â”‚
  â”‚      â–¼                  â–¼             â–¼
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  â”‚Backend â”‚        â”‚Backend â”‚    â”‚Backend â”‚
  â”‚  â”‚Broadcast        â”‚Broadcast     â”‚Broadcast
  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
  â”‚       â”‚                 â”‚             â”‚
  â”‚       â–¼                 â–¼             â–¼
  â”‚   â”Œâ”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”
  â”‚   â”‚ DB â”‚            â”‚ DB â”‚        â”‚ DB â”‚
  â”‚   â””â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”˜
  â”‚       â”‚                 â”‚             â”‚
  â–¼       â–¼                 â–¼             â–¼
[UI]    [UI]              [UI]          [UI]
```

---

## ğŸ“ Component Hierarchy

```
GroupChatScreen
â”œâ”€â”€ GroupChatHeader
â”‚   â”œâ”€â”€ Back Button
â”‚   â”œâ”€â”€ Group Avatar
â”‚   â”œâ”€â”€ Group Name + Member Count
â”‚   â””â”€â”€ More Menu
â”‚
â”œâ”€â”€ MessageActionsBar (when selection mode)
â”‚   â”œâ”€â”€ Copy
â”‚   â”œâ”€â”€ Pin/Unpin
â”‚   â”œâ”€â”€ Star/Unstar
â”‚   â”œâ”€â”€ Delete
â”‚   â””â”€â”€ Forward
â”‚
â”œâ”€â”€ FlashList (messages)
â”‚   â”œâ”€â”€ DateSeparator (when date changes)
â”‚   â””â”€â”€ GroupMessageBubble (per message)
â”‚       â”œâ”€â”€ Avatar (if not outgoing & show sender)
â”‚       â”œâ”€â”€ Sender Name (if show sender)
â”‚       â”œâ”€â”€ Message Content (text/image/video)
â”‚       â”œâ”€â”€ Timestamp
â”‚       â”œâ”€â”€ Status Icon (if outgoing)
â”‚       â”œâ”€â”€ Reaction Summary
â”‚       â””â”€â”€ Pin/Star Indicators
â”‚
â”œâ”€â”€ TypingIndicator (when someone typing)
â”‚
â”œâ”€â”€ ChatInput
â”‚   â”œâ”€â”€ TextInput
â”‚   â”œâ”€â”€ Attachment Button
â”‚   â”œâ”€â”€ Send Button
â”‚   â””â”€â”€ Reply Preview (if replying)
â”‚
â”œâ”€â”€ MessageReactionPicker (when shown)
â”‚
â””â”€â”€ GroupMemberListModal (when opened)
    â”œâ”€â”€ Header (title + close)
    â”œâ”€â”€ Search Input
    â”œâ”€â”€ Member List
    â”‚   â””â”€â”€ Member Item
    â”‚       â”œâ”€â”€ Avatar
    â”‚       â”œâ”€â”€ Name + Role Badge
    â”‚       â””â”€â”€ Actions (if admin)
    â”‚           â”œâ”€â”€ Make Admin
    â”‚           â””â”€â”€ Remove
    â””â”€â”€ Add Member Button (if admin)
```

---

These diagrams provide a visual understanding of the architecture at different levels. Refer to them when integrating or debugging the system.



